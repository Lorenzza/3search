# API Поисковой системы по отзывам к фильмам

## Общая информация

Поисковая система предоставляет REST API для поиска по отзывам к фильмам с использованием различных методов поиска.

**Базовый URL:** `http://localhost:8000`

## Методы поиска

Система поддерживает три метода поиска:

1. **Полнотекстовый поиск** (метод 1)
   - Использует Elasticsearch
   - Оптимален для поиска по точным фразам
   - Учитывает морфологию русского языка

2. **Векторный поиск** (метод 2)
   - Использует FAISS и SentenceTransformers
   - Находит семантически похожие тексты
   - Эффективен для поиска по смыслу

3. **Гибридный поиск** (метод 3)
   - Комбинирует результаты обоих методов
   - Обеспечивает баланс между точностью и семантикой
   - Автоматически удаляет дубликаты

## Endpoints

### POST /api/v1/search

Выполняет поиск по отзывам с указанными параметрами.

#### Запрос
son
{
"query": "Захватывающий сюжет с неожиданной концовкой",
"top_k": 5,
"method": 1
}

**Параметры:**
- `query` (string, обязательный) - поисковый запрос
- `top_k` (integer, 3-21) - количество результатов
- `method` (integer, 1-3) - метод поиска

#### Ответ
json
{
"results": [
{
"movie_id": "tt0111161",
"score": 0.85,
"content": "Отличный фильм с захватывающим сюжетом...",
"source": "fulltext"
}
],
"metrics": {
"max_similarity": 0.85,
"average_similarity": 0.72,
"latency": 0.156,
"total_results": 42
}
}
**Поля результатов:**
- `movie_id` - идентификатор фильма
- `score` - оценка релевантности (0-1)
- `content` - текст отзыва
- `source` - источник результата

**Метрики:**
- `max_similarity` - максимальная оценка сходства
- `average_similarity` - средняя оценка сходства
- `latency` - время выполнения (сек)
- `total_results` - общее количество найденных результатов

## Примеры использования

### Python (с использованием httpx)
python
import httpx
async def search_reviews(query: str, top_k: int = 5, method: int = 1):
async with httpx.AsyncClient() as client:
response = await client.post(
"http://localhost:8000/api/v1/search",
json={
"query": query,
"top_k": top_k,
"method": method
}
)
return response.json()
Использование
results = await search_reviews(
query="Захватывающий сюжет",
top_k=5,
method=1
)
### cURL
bash
curl -X POST "http://localhost:8000/api/v1/search" \
-H "Content-Type: application/json" \
-d '{
"query": "Захватывающий сюжет",
"top_k": 5,
"method": 1
}'

## Коды ошибок

| Код  | Описание                                    |
|------|---------------------------------------------|
| 400  | Некорректные параметры запроса             |
| 422  | Ошибка валидации параметров                |
| 500  | Внутренняя ошибка сервера                  |
| 503  | Сервис временно недоступен                 |

## Ограничения

1. Максимальная длина запроса: 1000 символов
2. Максимальное количество результатов: 21
3. Rate limit: 100 запросов в минуту

## Рекомендации по использованию

1. **Выбор метода поиска:**
   - Для точных фраз используйте метод 1
   - Для поиска по смыслу используйте метод 2
   - Для общего случая используйте метод 3

2. **Оптимизация запросов:**
   - Начинайте с небольшого количества результатов
   - Используйте конкретные запросы
   - Следите за метриками производительности

## Поддержка

При возникновении проблем или вопросов:
1. Проверьте документацию
2. Посмотрите примеры использования
3. Создайте issue в репозитории проекта
